{"version":3,"sources":["../../../../node_modules/%40clerk/nextjs/dist/esm/app-router/server-actions.js","../../../../.next-internal/server/app/workout/new/page/actions.js%20%28server%20actions%20loader%29","../../../../app/workout/new/action.ts"],"sourcesContent":["\"use server\";\nimport { cookies } from \"next/headers\";\nasync function invalidateCacheAction() {\n  void (await cookies()).delete(`__clerk_invalidate_cache_cookie_${Date.now()}`);\n}\nexport {\n  invalidateCacheAction\n};\n","export {detectKeylessEnvDriftAction as '7f00aa33224ad7f5625ae15d101f59bc64b153d43b'} from 'ACTIONS_MODULE0'\nexport {invalidateCacheAction as '7f8a5d76e826325ce7dd010842a67756b2cddddf7e'} from 'ACTIONS_MODULE1'\nexport {createOrReadKeylessAction as '7f9a14fcdd8e4bdc58ad32c320e379d85f1acf6501'} from 'ACTIONS_MODULE0'\nexport {formatMetadataHeaders as '7faa8bb475b36a172a0de85e700f1e126054c1ab93'} from 'ACTIONS_MODULE2'\nexport {collectKeylessMetadata as '7fcb61e00348cc2d63111375d9cbb8c1a1c5c1c232'} from 'ACTIONS_MODULE2'\nexport {detectKeylessEnvDriftAction as '7f00aa33224ad7f5625ae15d101f59bc64b153d43b'} from 'ACTIONS_MODULE0'\nexport {deleteKeylessAction as '7f5041eb519a7fba49dd2f9549f0a73f36bc2d4bfa'} from 'ACTIONS_MODULE0'\nexport {createOrReadKeylessAction as '7f9a14fcdd8e4bdc58ad32c320e379d85f1acf6501'} from 'ACTIONS_MODULE0'\nexport {syncKeylessConfigAction as '7fbe15cad3a1d51e92fe21855c4fcf4ebb2c6262cd'} from 'ACTIONS_MODULE0'\nexport {deleteKeylessAction as '7f5041eb519a7fba49dd2f9549f0a73f36bc2d4bfa'} from 'ACTIONS_MODULE0'\nexport {syncKeylessConfigAction as '7fbe15cad3a1d51e92fe21855c4fcf4ebb2c6262cd'} from 'ACTIONS_MODULE0'\nexport {createWorkoutAction as '40cbe8cf1b11d76f18bad4722112aaec74dc93ab6c'} from 'ACTIONS_MODULE3'\n","\"use server\"\n\nimport { z } from 'zod'\nimport { createWorkout } from '@/data/workouts'\nimport { auth } from '@clerk/nextjs/server'\nimport { format } from 'date-fns'\n\n// Simple validation schema\nconst CreateWorkoutSchema = z.object({\n  title: z.string().min(1, 'Title is required').max(100),\n  notes: z.string().optional(),\n  startTime: z.string().optional(),\n  workoutDate: z.string().min(1, 'Date is required'),\n})\n\nexport async function createWorkoutAction(data: z.infer<typeof CreateWorkoutSchema>) {\n  console.log('Action called with data:', data)\n\n  try {\n    // Validate input data\n    const validatedData = CreateWorkoutSchema.parse(data)\n    console.log('Validation passed:', validatedData)\n\n    // Get authenticated user\n    const { userId } = await auth()\n    console.log('User ID:', userId)\n\n    if (!userId) {\n      throw new Error('User not authenticated')\n    }\n\n    // Parse workout date and create proper datetime with timezone preservation\n    // The workoutDate should be in YYYY-MM-DD format from the date picker\n    let startedAt: Date\n\n    if (validatedData.startTime) {\n      // Combine date and time properly to preserve local timezone\n      const [hours, minutes] = validatedData.startTime.split(':')\n      const [year, month, day] = validatedData.workoutDate.split('-').map(Number)\n\n      // Create date using local timezone (not UTC)\n      // This ensures the date/time is interpreted in the user's local timezone\n      startedAt = new Date(year, month - 1, day, parseInt(hours), parseInt(minutes), 0, 0)\n\n      console.log('Local timezone components:', { year, month, day, hours, minutes })\n      console.log('Created local datetime:', startedAt)\n      console.log('Local datetime ISO:', startedAt.toISOString())\n    } else {\n      // If no time provided, use the date at noon in local timezone\n      const [year, month, day] = validatedData.workoutDate.split('-').map(Number)\n      startedAt = new Date(year, month - 1, day, 12, 0, 0, 0)\n\n      console.log('Local date with default time:', startedAt)\n      console.log('Local datetime ISO:', startedAt.toISOString())\n    }\n\n    console.log('Final datetime for DB (preserves local timezone):', startedAt.toISOString())\n\n    // Call data helper function\n    const workout = await createWorkout({\n      userId,\n      title: validatedData.title,\n      notes: validatedData.notes,\n      startedAt,\n    })\n\n    console.log('Workout created:', workout)\n    console.log('Workout startedAt date:', workout.startedAt)\n\n    // Format date for redirect\n    const redirectDate = format(workout.startedAt, 'yyyy-MM-dd')\n    console.log('Formatted redirect date:', redirectDate)\n\n    // Return success response with date for redirect\n    return {\n      success: true,\n      workout,\n      redirectDate\n    }\n\n  } catch (error) {\n    console.error('Error in createWorkoutAction:', error)\n\n    if (error instanceof z.ZodError) {\n      console.error('Zod errors:', error.issues)\n      throw new Error(error.issues[0]?.message || 'Validation error')\n    }\n\n    // Handle other errors\n    const errorMessage = error instanceof Error ? error.message : 'Unknown error'\n    console.error('Error message:', errorMessage)\n    throw new Error(`Failed to create workout: ${errorMessage}`)\n  }\n}"],"names":[],"mappings":"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","ignoreList":[0]}